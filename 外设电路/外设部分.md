
## 外设部分
### 1 过流保护电路
#### 1.0 功能阐述
该模块的预期作用是当输出电流小于1A时，电路正常工作；输出电流超过1A时，通过反馈给单片机断开电路，以保护元件。
#### 1.1 电路设计历程
对于过流保护电路，最初的设想是通过一个采样电阻将电流信号转化为电压信号，控制三极管通断以改变MOS管的栅极电压，达到通断电路的目的，如图1.1-1所示。

![输入图片说明](/imgs/2025-12-22/TFdsV6MykZPAfBUG.svg+xml)
$$图1.1-1$$
但在具体实验时，发现电路中MOS管在整个工作状态下始终具有很大的分压（电压12V，电流0.3A条件下，就具有10V左右电压），经分析，发现原因是MOS管处于线性放大区，具有较大的等效电阻。
  
之后对该电路做出改进，如图1.1-2所示，在电流信号转化为电压信号后，进行电压比较，输出高低电平反馈给单片机来通断电路。

![图1.1-2](/imgs/2025-12-22/pH3U7uvIQAmY4ie7.svg+xml)
$$图1.1-2$$
但具体实验时，发现电压比较器的输出结果不稳定（高低电平交替），经分析，是三极管的存在破坏了电压比较器的拓扑结构，同时其自身的通断状况也会改变其总体的等效电路，进而改变基极与集电极的电压。

最终，受电流传感器的启发，现采用运算放大器的运算性质采集采样电阻两端电压，并与基准电压比较，输出的高低电平反馈给单片机来进行过流保护，如图1.1-3所示。

![输入图片说明](/imgs/2025-12-22/FOFyhCWinBSSFcXX.svg+xml)
$$图1.1-3$$
#### 1.2 具体电路分析
该模块主要分为电流采样电路、电压比较电路、反馈电路三部分。

 ![输入图片说明](/imgs/2025-12-22/05EYI6VXuBSX3k6l.svg+xml)
 $$图1.2-1$$
其中，电压比较器LM2903P进行电压比较时需要接一个上拉电阻R~6~，且输出端是一个三极管结构，其原理是当同相输入端电压小于反相输入端电压时，三极管导通，输出电压是三极管发射级与集电极两端电压，一般小于0.7V，为低电平；当同相输入端电压大于反相输入端电压时，三极管截止，输出电压近似为VCC-input。
  
该保护电路先利用运放对采样电阻两端电压进行减法运算，将电流信号转化为电压信号，其中输出电压与输入电压之间的关系为
$$ 
Uo =\frac{R~5~}{R~4~+R~5~}*\frac{R~2~+R~3~}{R~3~}*Ui1-\frac{R~2~}{R~3~}*Ui2
$$
实际电路中，将R~2~、R~3~、R~4~、R~5~均设置为1kΩ，则有
$$
Uo=Ui1-Ui2
$$
之后，将U~o~与利用稳压管提供的基准电压进行比较输出，经过限幅电路输出高低电平传给单片机。其中运放的作用是将上拉电阻（一般1到10kΩ）与限幅电路进行隔离，使限流电阻R~8~与稳压管匹配
 
经过实验，该种方案设计的电路能够在电路电流为1.02A时，单片机会断开电路，结果基本符合预期。
### 2  过压保护电路
#### 2.0 功能阐述
该模块的作用是当输出电压大于20V时，断开电路，防止对半导体器件造成不可逆损害。
#### 2.1 电路设计历程
对于电压保护电路，最初的设想与过流保护电路类似，原理都是利用三极管的通断情况控制MOS管的通断进而控制电路，如图2.1-1所示。

![图2.1-1](/imgs/2025-12-22/98rbbb8NkUjCoQKR.svg+xml)
$$图2.1-1$$
但在具体实验时，遇到与过流保护电路类似的情况，MOS占有很高的电压，会对主稳压回路造成影响，故不采用这一设想。

最终确定的方案依旧是进行电压比较，反馈给单片机，其间用到了稳压管的稳压特性。

#### 2.2 具体电路分析
过压保护电路如图2.2-1所示。

![图2.2-1](/imgs/2025-12-22/Ttu2KH8jCIAuaiYk.svg+xml)
$$图2.2-1$$
该电路并联在稳压电压输出的两端，其中
$$
R4=R1,R5>R2(略大于）
$$
正常情况下，电压比较器反向输入端电压低于同相输入端，输出低电平；当稳压电源输出电压达到阈值时，R~5~两端电压（即反向输入端电压）稳定至稳压管两端电压，此时同向输入端大于反向输入端，输出高电平，经限幅电路反馈给单片机，断开电路。其中运放作用与过流保护电路中的运放作用相同。

经实验，当输出电压输出20.8V左右电压时，过压保护电路输出高电平，单片机会断开电路，基本符合预期。

### 3 过热保护电路
#### 3.0 功能概述
该模块的作用是当稳压电源内部温度超过75摄氏度时，启动过热保护，断开电路；当温度恢复至55摄氏度以下，开启电路，实现过热保护软开关设计。
#### 3.1 具体电路分析
为达到预期目标，该模块的主体采用滞回比较器的电路结构，如图3.1-1所示。

![图3.1-1](/imgs/2025-12-22/fMxhmvJm5GIR6id7.svg+xml)
$$图3.1-1$$
其中U~2~是一个负温度系数的热敏电阻，温度较低时，电压比较器输出低电平；温度较高时，电压比较器输出高电平。其中高温时，上拉电阻还起到迟滞作用，提高比较器的门限电压，使电路只有在温度降低至一定值时，才会开启。

经过实验，当稳压电源内部温度超过80摄氏度时，启动过热保护，断开电路；当温度恢复至62摄氏度左右，开启电路，基本到达预期。


